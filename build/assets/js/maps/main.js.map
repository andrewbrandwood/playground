{"version":3,"sources":["forms_storage.js","main.js"],"names":["window","storeForms","storageType","this","setStorage","init","prototype","storageAvailable","forms","document","querySelector","placeholders","querySelectorAll","formFields","bindEvents","populatePlaceholders","populateFormFields","x","storage","setItem","removeItem","e","addEventListener","processForm","bind","i","length","placeholder","name","getAttribute","value","getItem","showIf","hideIf","style","display","innerHTML","replace","processed","field","indexOf","type","fieldToCheck","checked","push","saveItem","key","event","target","elements","getFieldValue","trim"],"mappings":"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","file":"../main.js","sourcesContent":["(function() {\n  'use strict';\n\n  window.storeForms = function(storageType) {\n    this.setStorage(storageType);\n    return this.init();\n  };\n\n  storeForms.prototype.setStorage = function(storageType) {\n    this.storageType = storageType ? storageType : 'sessionStorage';\n  };\n\n  storeForms.prototype.init = function() {\n    if (this.storageAvailable()) {\n      this.forms = document.querySelector('form');\n      this.placeholders = document.querySelectorAll('[data-name]');\n      this.formFields = document.querySelectorAll('form [name]');\n\n      this.bindEvents();\n      this.populatePlaceholders();\n      this.populateFormFields();\n    }\n  };\n\n  storeForms.prototype.storageAvailable = function() {\n    try {\n      var x = '__storage_test__';\n      this.storage = window[this.storageType];\n      this.storage.setItem(x, x);\n      this.storage.removeItem(x);\n      return true;\n    }\n    catch(e) {\n      return false;\n    }\n  };\n\n  storeForms.prototype.bindEvents = function() {\n    if (this.forms) {\n      this.forms.addEventListener('submit', this.processForm.bind(this));\n    }\n  };\n\n  storeForms.prototype.populatePlaceholders = function() {\n    for (var i = 0; i < this.placeholders.length; i++) {\n      var placeholder = this.placeholders[i],\n          name = placeholder.getAttribute('data-name'),\n          value = this.getItem(name) || '',\n          showIf = placeholder.getAttribute('data-show-if'),\n          hideIf = placeholder.getAttribute('data-hide-if');\n\n      if (name) {\n        if (showIf) {\n          if (showIf === ':empty') {\n            if (value) {\n              placeholder.style.display = 'none';\n            }\n          }\n          else if (showIf !== value) {\n            placeholder.style.display = 'none';\n          }\n        }\n        else if (hideIf) {\n          if (hideIf === ':empty') {\n            if (!value) {\n              placeholder.style.display = 'none';\n            }\n          }\n          else if (hideIf === value) {\n            placeholder.style.display = 'none';\n          }\n        }\n        else {\n          placeholder.innerHTML = value.replace(/\\n\\r?/g, '<br />');\n        }\n      }\n    }\n  };\n\n  storeForms.prototype.populateFormFields = function() {\n    var processed = [];\n\n    if (this.formFields) {\n      for (var i = 0; i < this.formFields.length; i++) {\n        var field = this.formFields[i],\n            name = field.getAttribute('name'),\n            value = this.getItem(name);\n\n        if (name && processed.indexOf(name) === -1) {\n          switch(field.type) {\n            case 'radio':\n            case 'checkbox':\n            var fieldToCheck = document.querySelector('[name=\"' + name + '\"][value=\"' + value + '\"]');\n              if (fieldToCheck) {\n                fieldToCheck.checked = true;\n              }\n              break;\n            default:\n              if (value) {\n                field.value = value;\n              }\n              break;\n          }\n\n          processed.push(name);\n        }\n      }\n    }\n  };\n\n  storeForms.prototype.saveItem = function(key, value) {\n    this.storage.setItem(key, value);\n  };\n\n  storeForms.prototype.removeItem = function(key) {\n    this.storage.removeItem(key);\n  };\n\n  storeForms.prototype.getItem = function(key) {\n    return this.storage.getItem(key);\n  };\n\n  storeForms.prototype.processForm = function(event) {\n    var processed = [];\n\n    for (var i = 0; i < event.target.elements.length; i++) {\n      var field = event.target.elements[i],\n          name = field.getAttribute('name'),\n          value;\n\n      if (name && processed.indexOf(name) === -1) {\n        value = this.getFieldValue(field);\n\n        if (value) {\n          this.saveItem(name, value);\n        }\n        else {\n          this.removeItem(name);\n        }\n        processed.push(name);\n      }\n    }\n  };\n\n  storeForms.prototype.getFieldValue = function(field) {\n    if (!field) return;\n\n    switch(field.type) {\n      case 'radio':\n        var name = field.getAttribute('name'),\n            checked = document.querySelector('[name=\"' + name + '\"]:checked');\n        return checked ? checked.getAttribute('value') : '';\n      case 'checkbox':\n        return field.checked ? field.value : '';\n      default:\n        return field.value.trim();\n    }\n  };\n}());\n","var storeForms = new storeForms();\n"]}